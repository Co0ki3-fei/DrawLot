/* empty css                  */import{_ as b}from"./PlayerCard-C6AYfe3R.js";/* empty css                  */import{r as u,c as y,o as E,e as P,g as s,d,w as r,t,u as F,p as N,B as U,b as B,h as T,F as j,f as A,j as H,D as K,G as $}from"./index-KxJKXHH8.js";import{C}from"./CustomTable-CZoFKS4D.js";/* empty css                        */import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"second-round"},z={class:"nextBt"},J={class:"body"},Q={class:"bgm-text"},X={class:"player-form"},Y={class:"score"},Z={class:"score-res"},ee={class:"pool"},oe={class:"player-pool"},se={class:"pp-table"},le={class:"pool-cell"},re={class:"pool-cell"},te={class:"pool-cell"},ne={class:"pool-cell"},ae={class:"bgm-pool"},de={class:"bp-table"},ue={class:"pool-cell"},ce={class:"pool-cell"},ie={class:"pool-cell"},Re={__name:"ThirdRoundView",setup(pe){const k=H(),i=F();u("bgm_name");const x=u(!1),n=u({}),a=u({}),m=u(0),f=y(()=>i.getters["group/compGroup"].filter(o=>o.secondRoundOrder!==0).sort((o,e)=>o.group!==e.group?o.group-e.group:o.secondRoundOrder-e.secondRoundOrder)),M=y(()=>{var e,_,h,g,v,l,S,w;const o=f.value;return o.length!==8?[]:[{fist_group:((e=o[0])==null?void 0:e.name)||"",second_group:((_=o[2])==null?void 0:_.name)||"",third_group:((h=o[4])==null?void 0:h.name)||"",forth_group:((g=o[6])==null?void 0:g.name)||""},{fist_group:((v=o[7])==null?void 0:v.name)||"",second_group:((l=o[5])==null?void 0:l.name)||"",third_group:((S=o[3])==null?void 0:S.name)||"",forth_group:((w=o[1])==null?void 0:w.name)||""}]});E(()=>{const o=f.value;o.length===8&&(n.value=o[0],a.value=o[7],x.value=!0),console.log("clearPlayerIsThirdWinner"),i.dispatch("group/clearPlayerIsThirdWinner")});const p=(o,e)=>{i.dispatch("group/updatePlayerThirdRoundScore",{playerId:o,score:e}),e>=2&&i.dispatch("group/updatePlayerIsThirdWinnerToWin",o)},W=(o,e)=>{p(o,e)},G=(o,e)=>{p(o,e)},D=()=>{if(!(n.value.thirdRoundScore>=2||a.value.thirdRoundScore>=2))return;if(p(n.value.playerId,n.value.thirdRoundScore),p(a.value.playerId,a.value.thirdRoundScore),m.value>=3){k.push("/ThirdRound/ThirdRoundWinnerListView");return}m.value++;const e=f.value;switch(m.value){case 1:n.value=e[2],a.value=e[5];break;case 2:n.value=e[4],a.value=e[3];break;case 3:n.value=e[6],a.value=e[1];break}},R=u("点击选择BGM"),c=["Megalovania - Undertale","One Winged Angel - FF7","The Only Thing I Know For Real - MGR","Bury the Light - DMC5","Red Sun in the Sky - MGR","It Has To Be This Way - MGR","Devil Trigger - DMC5","Rivers in the Desert - P5","Last Surprise - P5","Life Will Change - P5","Take Over - P5R","I Believe - P5R"],I=o=>{R.value=o},L=y(()=>{const o=[];for(let e=0;e<c.length;e+=3)o.push({col1:c[e]||"",col2:c[e+1]||"",col3:c[e+2]||""});return o}),O=[{prop:"fist_group",label:"第一组"},{prop:"second_group",label:"第二组"},{prop:"third_group",label:"第三组"},{prop:"forth_group",label:"第四组"}],V=[{prop:"col1",label:"第一列"},{prop:"col2",label:"第二列"},{prop:"col3",label:"第三列"}];return(o,e)=>{const _=N,h=K,g=$,v=U;return B(),P("div",q,[s("div",z,[d(_,{onClick:D},{default:r(()=>e[3]||(e[3]=[T("下一组")])),_:1})]),s("div",J,[e[7]||(e[7]=s("div",{class:"title fire-text"},"八强对决",-1)),s("div",{class:"bgm",onClick:e[0]||(e[0]=l=>o.showBgmSelect=!0)},[d(v,{trigger:"click",onCommand:I},{dropdown:r(()=>[d(g,null,{default:r(()=>[(B(),P(j,null,A(c,l=>d(h,{key:l,command:l},{default:r(()=>[T(t(l),1)]),_:2},1032,["command"])),64))]),_:1})]),default:r(()=>[s("span",Q,"BGM: "+t(R.value),1)]),_:1})]),s("div",X,[d(b,{player:n.value,"onUpdate:player":e[1]||(e[1]=l=>n.value=l),"allow-player-change":!1,"max-score":2,"fetch-score":l=>l.thirdRoundScore||0,onScoreChange:W},null,8,["player","fetch-score"]),s("div",Y,[e[4]||(e[4]=s("div",{class:"score-txt"},"VS",-1)),s("div",Z,t(n.value.thirdRoundScore||0)+":"+t(a.value.thirdRoundScore||0),1)]),d(b,{player:a.value,"onUpdate:player":e[2]||(e[2]=l=>a.value=l),"allow-player-change":!1,"max-score":2,"fetch-score":l=>l.thirdRoundScore||0,onScoreChange:G},null,8,["player","fetch-score"])]),s("div",ee,[s("div",oe,[e[5]||(e[5]=s("div",{class:"pp-title"},"选手池",-1)),s("div",se,[d(C,{data:M.value,columns:O,"show-header":!1},{fist_group:r(({row:l})=>[s("div",le,[s("span",null,t(l.fist_group),1)])]),second_group:r(({row:l})=>[s("div",re,[s("span",null,t(l.second_group),1)])]),third_group:r(({row:l})=>[s("div",te,[s("span",null,t(l.third_group),1)])]),forth_group:r(({row:l})=>[s("div",ne,[s("span",null,t(l.forth_group),1)])]),_:1},8,["data"])])]),s("div",ae,[e[6]||(e[6]=s("div",{class:"bp-title"},"BGM池",-1)),s("div",de,[d(C,{data:L.value,columns:V,"show-header":!1},{col1:r(({row:l})=>[s("div",ue,[s("span",null,t(l.col1),1)])]),col2:r(({row:l})=>[s("div",ce,[s("span",null,t(l.col2),1)])]),col3:r(({row:l})=>[s("div",ie,[s("span",null,t(l.col3),1)])]),_:1},8,["data"])])])])])])}}};export{Re as default};
