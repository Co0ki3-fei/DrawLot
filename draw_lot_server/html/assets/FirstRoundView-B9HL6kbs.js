/* empty css                  *//* empty css               *//* empty css                  *//* empty css                  */import{a as n,r as h,c as k,g as l,e as p,w as v,t as i,s as E,v as T,p as N,o as S,F as U,f as D,d as M,h as j,j as z,u as A,x as O}from"./index-BLItbW6-.js";import{c as $}from"./utils-BJkYNDuZ.js";import{_ as F}from"./PlayerCard-QXu9l7Mb.js";import{C as q}from"./CustomTable-D5_KmM30.js";/* empty css                        */import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"page"},J={class:"group-selector"},K={class:"body"},Q={class:"title fire-text"},X={class:"bgm"},Y={class:"player-form"},Z={class:"score"},ee={class:"score-res"},le={class:"skill"},oe={class:"skill-pool"},se={class:"pool-cell"},te={class:"pool-cell"},re={class:"pool-cell"},ae=3,_e={__name:"FirstRoundView",setup(ue){const C=z(),a=A(),I=n(()=>a.getters["group/compGroup"]),c=h([]),d=h([]),g=n(()=>a.getters["group/getBgm"]),_=n(()=>a.state.skillPool),u=h(0);for(let o=0;o<16;o++)I.value.forEach(e=>{e.firstRoundGroup===o&&e.isBetter?c.value.push({...e,firstRoundScore:e.firstRoundScore??0}):e.firstRoundGroup===o&&!e.isBetter&&d.value.push({...e,firstRoundScore:e.firstRoundScore??0})});const b=n(()=>g.value&&g.value[u.value]?g.value[u.value]:"bgm_name"),t=n(()=>c.value&&c.value[u.value]?c.value[u.value]:{name:"NULL",avatar:"",firstRoundScore:0}),r=n(()=>d.value&&d.value[u.value]?d.value[u.value]:{name:"NULL",avatar:"",firstRoundScore:0}),P=n(()=>t.value.firstRoundScore>=1||r.value.firstRoundScore>=1),y=h([]);y.value=$(_.value,ae);function W(){if(!P.value){E({message:"请先选出胜者，再进行下一组比赛",type:"error",duration:2e3});return}if(t.value.firstRoundScore>r.value.firstRoundScore?(t.value.isFirstWinner=!0,r.value.isFirstWinner=!1,a.dispatch("group/updateGroupIsFirstWinnerToWin",t.value.playerId),a.dispatch("group/updateGroupIsFirstWinnerToDefeat",r.value.playerId)):(t.value.isFirstWinner=!1,r.value.isFirstWinner=!0,a.dispatch("group/updateGroupIsFirstWinnerToWin",r.value.playerId),a.dispatch("group/updateGroupIsFirstWinnerToDefeat",t.value.playerId)),u.value===15){C.push("/FirstRound/FirstRoundWinnerListView");return}u.value+=1}function G(o,e){t.value.firstRoundScore=e,a.dispatch("group/updatePlayerFirstRoundScore",{playerId:t.value.playerId,score:e})}function x(o,e){r.value.firstRoundScore=e,a.dispatch("group/updatePlayerFirstRoundScore",{playerId:r.value.playerId,score:e})}function B(o){t.value.firstRoundSkill=o,a.dispatch("group/updatePlayerFirstRoundSkill",{playerId:t.value.playerId,skill:o})}function L(o){r.value.firstRoundSkill=o,a.dispatch("group/updatePlayerFirstRoundSkill",{playerId:r.value.playerId,skill:o})}const R=n(()=>{const o=[];for(let e=0;e<c.value.length;e++){const f=c.value[e],m=d.value[e];f&&m&&(f.isFirstWinner||m.isFirstWinner)&&o.push(e)}return o}),V=[{prop:"column1",label:"第一列"},{prop:"column2",label:"第二列"},{prop:"column3",label:"第三列"}];return(o,e)=>{const f=O,m=T,w=N;return S(),k("div",H,[l("div",J,[p(m,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),placeholder:"选择已完成的对战组",disabled:R.value.length===0},{default:v(()=>[(S(!0),k(U,null,D(R.value,s=>(S(),M(f,{key:s,label:`${String.fromCharCode(65+s)}组`,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),p(w,{onClick:W},{default:v(()=>e[3]||(e[3]=[j("下一组")])),_:1})]),l("div",K,[l("div",Q,"三十二强对决 - "+i(String.fromCharCode(65+u.value))+" 组对决",1),l("div",X,"BGM: "+i(b.value),1),l("div",Y,[p(F,{player:t.value,"onUpdate:player":e[1]||(e[1]=s=>t.value=s),"show-skill-select":!0,skills:_.value,"max-score":1,onScoreChange:G,onSkillChange:B},null,8,["player","skills"]),l("div",Z,[e[4]||(e[4]=l("div",{class:"score-txt"},"VS",-1)),l("div",ee,i(t.value.firstRoundScore)+":"+i(r.value.firstRoundScore),1)]),p(F,{player:r.value,"onUpdate:player":e[2]||(e[2]=s=>r.value=s),"show-skill-select":!0,skills:_.value,"max-score":1,onScoreChange:x,onSkillChange:L},null,8,["player","skills"])]),l("div",le,[e[5]||(e[5]=l("div",{class:"skill-title"},"技池",-1)),l("div",oe,[p(q,{data:y.value,columns:V,"show-header":!1},{column1:v(({row:s})=>[l("div",se,[l("span",null,i(s[0]),1)])]),column2:v(({row:s})=>[l("div",te,[l("span",null,i(s[1]),1)])]),column3:v(({row:s})=>[l("div",re,[l("span",null,i(s[2]),1)])]),_:1},8,["data"])])])])])}}};export{_e as default};
