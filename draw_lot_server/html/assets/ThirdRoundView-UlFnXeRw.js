/* empty css                  */import{_ as B}from"./PlayerCard-C33NtiRd.js";/* empty css                  */import{r as d,a as m,b as N,c as P,g as l,e as u,w as r,t,u as O,p as F,B as U,o as b,h as x,F as j,f as $,d as q,j as z,D as A,G as H}from"./index-BF88ooPF.js";import{C as k}from"./CustomTable-C9I30fVM.js";/* empty css                        */import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"second-round"},K={class:"nextBt"},Q={class:"body"},X={class:"bgm-text"},Y={class:"player-form"},Z={class:"score"},oo={class:"score-res"},eo={class:"pool"},lo={class:"player-pool"},so={class:"pp-table"},ro={class:"pool-cell"},to={class:"pool-cell"},no={class:"pool-cell"},ao={class:"pool-cell"},uo={class:"bgm-pool"},co={class:"bp-table"},po={class:"pool-cell"},io={class:"pool-cell"},_o={class:"pool-cell"},So={__name:"ThirdRoundView",setup(vo){const C=z(),p=O();d("bgm_name");const T=d(!1),n=d({}),a=d({}),f=d(0),y=m(()=>p.getters["group/compGroup"].filter(e=>e.secondRoundOrder!==0).sort((e,o)=>e.group!==o.group?e.group-o.group:e.secondRoundOrder-o.secondRoundOrder)),W=m(()=>{var o,_,v,h,g,s,S,R;const e=y.value;return e.length!==8?[]:[{fist_group:((o=e[0])==null?void 0:o.name)||"",second_group:((_=e[2])==null?void 0:_.name)||"",third_group:((v=e[4])==null?void 0:v.name)||"",forth_group:((h=e[6])==null?void 0:h.name)||""},{fist_group:((g=e[7])==null?void 0:g.name)||"",second_group:((s=e[5])==null?void 0:s.name)||"",third_group:((S=e[3])==null?void 0:S.name)||"",forth_group:((R=e[1])==null?void 0:R.name)||""}]});N(()=>{const e=y.value;e.length===8&&(n.value=e[0],a.value=e[7],T.value=!0),console.log("clearPlayerIsThirdWinner"),p.dispatch("group/clearPlayerIsThirdWinner")});const i=(e,o)=>{p.dispatch("group/updatePlayerThirdRoundScore",{playerId:e,score:o}),o>=2&&p.dispatch("group/updatePlayerIsThirdWinnerToWin",e)},G=(e,o)=>{i(e,o)},I=(e,o)=>{i(e,o)},V=()=>{if(!(n.value.thirdRoundScore>=2||a.value.thirdRoundScore>=2))return;if(i(n.value.playerId,n.value.thirdRoundScore),i(a.value.playerId,a.value.thirdRoundScore),f.value>=3){C.push("/ThirdRound/ThirdRoundWinnerListView");return}f.value++;const o=y.value;switch(f.value){case 1:n.value=o[2],a.value=o[5];break;case 2:n.value=o[4],a.value=o[3];break;case 3:n.value=o[6],a.value=o[1];break}},w=d("点击选择BGM"),c=m(()=>p.getters["group/getBgm3"]),D=e=>{w.value=e},E=m(()=>{const e=[];for(let o=0;o<c.value.length;o+=4)e.push({col1:c.value[o]||"",col2:c.value[o+1]||"",col3:c.value[o+2]||"",col4:c.value[o+3]||""});return e}),M=[{prop:"fist_group",label:"第一组"},{prop:"second_group",label:"第二组"},{prop:"third_group",label:"第三组"},{prop:"forth_group",label:"第四组"}],L=[{prop:"col1",label:"第一列"},{prop:"col2",label:"第二列"},{prop:"col3",label:"第三列"},{prop:"col4",label:"第四列"}];return(e,o)=>{const _=F,v=A,h=H,g=U;return b(),P("div",J,[l("div",K,[u(_,{onClick:V},{default:r(()=>o[3]||(o[3]=[x("下一组")])),_:1})]),l("div",Q,[o[7]||(o[7]=l("div",{class:"title fire-text"},"八强对决",-1)),l("div",{class:"bgm",onClick:o[0]||(o[0]=s=>e.showBgmSelect=!0)},[u(g,{trigger:"click",onCommand:D},{dropdown:r(()=>[u(h,null,{default:r(()=>[(b(!0),P(j,null,$(c.value,s=>(b(),q(v,{key:s,command:s},{default:r(()=>[x(t(s),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:r(()=>[l("span",X,"BGM: "+t(w.value),1)]),_:1})]),l("div",Y,[u(B,{player:n.value,"onUpdate:player":o[1]||(o[1]=s=>n.value=s),"allow-player-change":!1,"max-score":2,"fetch-score":s=>s.thirdRoundScore||0,onScoreChange:G},null,8,["player","fetch-score"]),l("div",Z,[o[4]||(o[4]=l("div",{class:"score-txt"},"VS",-1)),l("div",oo,t(n.value.thirdRoundScore||0)+":"+t(a.value.thirdRoundScore||0),1)]),u(B,{player:a.value,"onUpdate:player":o[2]||(o[2]=s=>a.value=s),"allow-player-change":!1,"max-score":2,"fetch-score":s=>s.thirdRoundScore||0,onScoreChange:I},null,8,["player","fetch-score"])]),l("div",eo,[l("div",lo,[o[5]||(o[5]=l("div",{class:"pp-title"},"选手池",-1)),l("div",so,[u(k,{data:W.value,columns:M,"show-header":!1},{fist_group:r(({row:s})=>[l("div",ro,[l("span",null,t(s.fist_group),1)])]),second_group:r(({row:s})=>[l("div",to,[l("span",null,t(s.second_group),1)])]),third_group:r(({row:s})=>[l("div",no,[l("span",null,t(s.third_group),1)])]),forth_group:r(({row:s})=>[l("div",ao,[l("span",null,t(s.forth_group),1)])]),_:1},8,["data"])])]),l("div",uo,[o[6]||(o[6]=l("div",{class:"bp-title"},"BGM池",-1)),l("div",co,[u(k,{data:E.value,columns:L,"show-header":!1},{col1:r(({row:s})=>[l("div",po,[l("span",null,t(s.col1),1)])]),col2:r(({row:s})=>[l("div",io,[l("span",null,t(s.col2),1)])]),col3:r(({row:s})=>[l("div",_o,[l("span",null,t(s.col3),1)])]),_:1},8,["data"])])])])])])}}};export{So as default};
