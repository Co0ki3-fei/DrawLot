/* empty css                  *//* empty css                        */import{a as D,r as s,b as z,d as w,u as A,o as u,w as l,e as i,c as f,f as k,n as E,g as y,h,t as v,F,i as O,j as H,k as U,E as J,l as K,m as Q,p as X,q as Y}from"./index-raWdJXYL.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $=[{playerId:1,name:"选手1",isBetter:!1,avatar:"imgs/001.jpg"},{playerId:2,name:"选手2",isBetter:!1,avatar:"imgs/002.jpg"},{playerId:3,name:"选手3",isBetter:!1,avatar:"imgs/003.jpg"},{playerId:4,name:"选手4",isBetter:!1,avatar:"imgs/004.jpg"},{playerId:5,name:"选手5",isBetter:!1,avatar:"imgs/005.jpg"},{playerId:6,name:"选手6",isBetter:!1,avatar:"imgs/006.jpg"},{playerId:7,name:"选手7",isBetter:!1,avatar:"imgs/007.jpg"},{playerId:8,name:"选手8",isBetter:!1,avatar:"imgs/008.jpg"},{playerId:9,name:"选手9",isBetter:!1,avatar:"imgs/009.jpg"},{playerId:10,name:"选手10",isBetter:!1,avatar:"imgs/010.jpg"},{playerId:11,name:"选手11",isBetter:!1,avatar:"imgs/011.jpg"},{playerId:12,name:"选手12",isBetter:!1,avatar:"imgs/012.jpg"},{playerId:13,name:"选手13",isBetter:!1,avatar:"imgs/013.jpg"},{playerId:14,name:"选手14",isBetter:!1,avatar:"imgs/014.jpg"},{playerId:15,name:"选手15",isBetter:!1,avatar:"imgs/015.jpg"},{playerId:16,name:"选手16",isBetter:!1,avatar:"imgs/016.jpg"},{playerId:17,name:"选手17",isBetter:!0,avatar:"imgs/017.jpg"},{playerId:18,name:"选手18",isBetter:!0,avatar:"imgs/018.jpg"},{playerId:19,name:"选手19",isBetter:!0,avatar:"imgs/019.jpg"},{playerId:20,name:"选手20",isBetter:!0,avatar:"imgs/020.jpg"},{playerId:21,name:"选手21",isBetter:!0,avatar:"imgs/021.jpg"},{playerId:22,name:"选手22",isBetter:!0,avatar:"imgs/022.jpg"},{playerId:23,name:"选手23",isBetter:!0,avatar:"imgs/023.jpg"},{playerId:24,name:"选手24",isBetter:!0,avatar:"imgs/024.jpg"},{playerId:25,name:"选手25",isBetter:!0,avatar:"imgs/025.jpg"},{playerId:26,name:"选手26",isBetter:!0,avatar:"imgs/026.jpg"},{playerId:27,name:"选手27",isBetter:!0,avatar:"imgs/027.jpg"},{playerId:28,name:"选手28",isBetter:!0,avatar:"imgs/028.jpg"},{playerId:29,name:"选手29",isBetter:!0,avatar:"imgs/029.jpg"},{playerId:30,name:"选手30",isBetter:!0,avatar:"imgs/030.jpg"},{playerId:31,name:"选手31",isBetter:!0,avatar:"imgs/031.jpg"},{playerId:32,name:"选手32",isBetter:!0,avatar:"imgs/032.jpg"}],ee={class:"form"},ae={class:"part1_id"},te={class:"group_id"},re={class:"part3_id"},se={class:"form"},le=Object.assign({name:"PreGroupView",inheritAttrs:!1},{__name:"PreGroupView",setup(ne){const T=H(),_=A(),G=D(()=>_.getters["group/compGroup"]),I=s([]),B=s([]),P=Object.assign({}),g=s([]),x=s(!0),p=s([]),d=s([]),n=s(0);z(async()=>{try{await Promise.all(Object.keys(P).map(e=>{const a=P[e];return a().then(r=>r.default)})),G.value&&G.value.length>0?(console.log("load pre round from store"),g.value=G.value.map(e=>({...e,isSelect:e.firstRoundGroup!==-1}))):(console.log("first open pre round, generated data"),g.value=$.map(e=>{let a={playerId:e.playerId,name:e.name,isBetter:e.isBetter,avatar:e.avatar,firstRoundGroup:-1,isFirstWinner:!1,secondRoundScore:0,secondRoundOrder:0,thirdRoundScore:0,thirdRoundOrder:0,isThirdWinner:!1,finalScore:0,finalOrder:0,isFinalWinner:!1};return _.dispatch("group/addToGroup",a),a})),p.value=g.value.filter(e=>e.isBetter),d.value=g.value.filter(e=>!e.isBetter),I.value=g.value.filter(e=>e.isBetter&&e.firstRoundGroup!==-1).sort((e,a)=>e.firstRoundGroup-a.firstRoundGroup),B.value=g.value.filter(e=>!e.isBetter&&e.firstRoundGroup!==-1).sort((e,a)=>e.firstRoundGroup-a.firstRoundGroup),n.value=B.value.length,x.value=!1}catch(e){console.error("图片加载失败",e),x.value=!1}});const j=s(!1),m=s(null),c=s(null);async function M(){if(n.value===16||j.value)return;j.value=!0,console.log("轮播开始"),N(),await q(1e3-n.value*60),console.log("轮播结束"),j.value=!1,_.dispatch("group/updateGroupFirstRoundGroup",{playerId:p.value.at(m.value).playerId,firstRoundGroup:n.value}),_.dispatch("group/updateGroupFirstRoundGroup",{playerId:d.value.at(c.value).playerId,firstRoundGroup:n.value});const e=p.value.at(m.value),a=d.value.at(c.value);I.value.push(e),B.value.push(a),p.value.at(m.value).isSelect=!0,d.value.at(c.value).isSelect=!0,n.value=n.value+1}function N(){let e=Math.floor(Math.random()*p.value.length),a=Math.floor(Math.random()*d.value.length);m.value=(m.value+e)%p.value.length,c.value=(c.value+a)%d.value.length;const r=setInterval(()=>{if(!j.value){clearInterval(r);return}m.value=C(p.value,m.value),c.value=C(d.value,c.value)},50)}function C(e,a){let r=a;do r=(r+1)%e.length;while(e[r].isSelect);return r}function q(e){return new Promise(a=>setTimeout(a,e))}function L(){T.push("/FirstRound/FirstRoundView"),U(()=>{const e=document.querySelector(".part1"),a=document.querySelector(".part3");e&&a&&(e.style.height="auto",a.style.height="auto")})}return(e,a)=>{const r=J,R=K,S=Q,V=X,W=Y;return u(),w(W,{gutter:20},{default:l(()=>[i(S,{span:8,class:"part1"},{default:l(()=>[(u(!0),f(F,null,k(p.value,(t,o)=>(u(),f("div",{class:E(["body",{highlighted:o===m.value&&!t.isSelect,gray:t.isSelect}]),key:o},[y("div",ee,[i(r,{src:t.avatar,alt:t.name},null,8,["src","alt"]),i(R,{class:"id"},{default:l(()=>[h(v(o+1),1)]),_:2},1024),i(R,{class:"name"},{default:l(()=>[h(v(t.name),1)]),_:2},1024)])],2))),128))]),_:1}),i(S,{span:8,class:"part2"},{default:l(()=>[(u(!0),f(F,null,k(I.value.length,t=>{var o,b;return u(),f("div",{class:"mid-part",key:t},[y("div",ae,v((o=I.value[t-1])==null?void 0:o.name),1),y("div",te,v(String.fromCharCode(65+t-1)),1),y("div",re,v((b=B.value[t-1])==null?void 0:b.name),1)])}),128)),y("div",null,[n.value<16?(u(),w(V,{key:0,onClick:M},{default:l(()=>a[0]||(a[0]=[h("下一组")])),_:1})):O("",!0),n.value===16?(u(),w(V,{key:1,onClick:L},{default:l(()=>a[1]||(a[1]=[h("第一轮·半区对决")])),_:1})):O("",!0)])]),_:1}),i(S,{span:8,class:"part3"},{default:l(()=>[(u(!0),f(F,null,k(d.value,(t,o)=>(u(),f("div",{class:E(["body",{highlighted:o===c.value&&!t.isSelect,gray:t.isSelect}])},[y("div",se,[i(r,{src:t.avatar,alt:t.name},null,8,["src","alt"]),i(R,{class:"id"},{default:l(()=>[h(v(o+17),1)]),_:2},1024),i(R,{class:"name"},{default:l(()=>[h(v(t.name),1)]),_:2},1024)])],2))),256))]),_:1})]),_:1})}}}),de=Z(le,[["__scopeId","data-v-c35f8334"]]);export{de as default};
